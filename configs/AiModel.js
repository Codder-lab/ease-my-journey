const {
  GoogleGenerativeAI,
  HarmCategory,
  HarmBlockThreshold,
} = require("@google/generative-ai");

const apiKey = process.env.EXPO_PUBLIC_GOOGLE_GEMINI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-2.0-flash",
});

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 40,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};

export const chatSession = model.startChat({
  generationConfig,
  history: [
    {
      role: "user",
      parts: [
        {
          text: "Generate Travel Plan for Location : Dubai - United Arab Emirates, for 6 Days and 5 Nights for Just Me with a Mid-Range budget with the Flight details, Approx Flight Price with Booking url, Hotel options list with HotelName, Hotel address, Price, Hotel image url, Geo Coordinates, ticket Pricing, Time to travel each of the location for 6 days and 5 night with each day plan with best time to visit in JSON format. Flight Prices should be in INR.",
        },
      ],
    },
    {
      role: "model",
      parts: [
        {
          text: '```json\n{\n  "tripDetails": {\n    "location": "Dubai, United Arab Emirates",\n    "duration": "6 Days, 5 Nights",\n    "travelerType": "Solo",\n    "budget": "Mid-Range",\n    "currency": "INR (Indian Rupees)",\n    "travelSeason": "November to March (Ideal)"\n  },\n  "flightDetails": {\n    "approximatePriceINR": 25000,\n    "bookingUrl": "https://www.skyscanner.co.in/",\n    "notes": "Flight prices can vary significantly. Check multiple booking sites (Skyscanner, Google Flights, MakeMyTrip, etc.) for the best deals. Book in advance for better rates. This is a roundtrip price estimate from a major Indian city."\n  },\n  "hotelOptions": [\n    {\n      "hotelName": "Citymax Hotel Bur Dubai",\n      "hotelAddress": "Kuwait Street, Bur Dubai, Dubai, United Arab Emirates",\n      "pricePerNightINR": 4000,\n      "imageUrl": "https://media-cdn.tripadvisor.com/media/photo-s/1b/41/85/5b/citymax-hotel-bur-dubai.jpg",\n      "geoCoordinates": {\n        "latitude": 25.2542,\n        "longitude": 55.3084\n      },\n      "notes": "Good value, convenient location, close to metro."\n    },\n    {\n      "hotelName": "Ibis Styles Dubai Airport Hotel",\n      "hotelAddress": "Airport Road, Al Garhoud, Dubai, United Arab Emirates",\n      "pricePerNightINR": 4500,\n      "imageUrl": "https://media-cdn.tripadvisor.com/media/photo-s/11/7e/72/3e/ibis-styles-dubai-airport.jpg",\n      "geoCoordinates": {\n        "latitude": 25.2492,\n        "longitude": 55.3594\n      },\n      "notes": "Close to the airport, good for early morning departures or late arrivals. Easy access to metro."\n    },\n   {\n      "hotelName": "Premier Inn Dubai Al Jaddaf",\n      "hotelAddress": "Al Jaddaf, Dubai, United Arab Emirates",\n      "pricePerNightINR": 3800,\n      "imageUrl": "https://media-cdn.tripadvisor.com/media/photo-s/1c/0a/44/00/premier-inn-dubai-al.jpg",\n      "geoCoordinates": {\n        "latitude": 25.2240,\n        "longitude": 55.3387\n      },\n      "notes": "Comfortable and well-located, close to metro station."\n    }\n  ],\n  "dailyItinerary": [\n    {\n      "day": 1,\n      "theme": "Arrival and Old Dubai Exploration",\n      "activities": [\n        {\n          "activityName": "Arrival at Dubai International Airport (DXB)",\n          "time": "Morning",\n          "approximateCostINR": 0,\n          "notes": "Take a taxi or the metro to your hotel.  Purchase a Nol card if using the metro.",\n          "travelTimeFromPrevious": "Variable, depending on airport transfer method."\n        },\n        {\n          "activityName": "Check-in at Hotel",\n          "time": "Afternoon",\n          "approximateCostINR": 0,\n          "notes": "Settle in and leave your luggage."\n        },\n        {\n          "activityName": "Dubai Creek Abra Ride",\n          "time": "Afternoon",\n          "approximateCostINR": 100,\n          "notes": "Experience traditional transportation across Dubai Creek.",\n          "geoCoordinates": {\n            "latitude": 25.2618,\n            "longitude": 55.3003\n          },\n          "travelTimeFromPrevious": "30 min from hotel"\n        },\n        {\n          "activityName": "Explore the Spice Souk and Gold Souk",\n          "time": "Late Afternoon",\n          "approximateCostINR": 0,\n          "notes": "Immerse yourself in the vibrant atmosphere and shop for souvenirs.",\n          "travelTimeFromPrevious": "5 min walk from abra station"\n        },\n        {\n          "activityName": "Dinner at Al Ustad Special Kabab",\n          "time": "Evening",\n          "approximateCostINR": 800,\n          "notes": "Enjoy delicious and affordable Iranian kebabs.",\n          "travelTimeFromPrevious": "10 min taxi ride from souks."\n        }\n      ]\n    },\n    {\n      "day": 2,\n      "theme": "Modern Dubai and Burj Khalifa",\n      "activities": [\n        {\n          "activityName": "Visit the Dubai Mall",\n          "time": "Morning",\n          "approximateCostINR": 0,\n          "notes": "Explore the vast shopping mall, window shop or indulge in some retail therapy.",\n           "travelTimeFromPrevious": "30 min metro ride from Bur Dubai"\n        },\n        {\n          "activityName": "Burj Khalifa - "At the Top" Observation Deck",\n          "time": "Afternoon",\n          "approximateCostINR": 3000,\n          "notes": "Book tickets in advance online to avoid long queues. Choose a time slot with good visibility.  Consider the 124th/125th floor for budget, or higher floors for a premium experience.",\n          "ticketPricingUrl": "https://www.burjkhalifa.ae/en/attractions/at-the-top/",\n          "geoCoordinates": {\n            "latitude": 25.1972,\n            "longitude": 55.2744\n          },\n          "travelTimeFromPrevious": "Within Dubai Mall"\n        },\n        {\n          "activityName": "Dubai Fountain Show",\n          "time": "Evening",\n          "approximateCostINR": 0,\n          "notes": "Watch the spectacular fountain show outside the Dubai Mall (every 30 minutes in the evening).",\n          "travelTimeFromPrevious": "Adjacent to Burj Khalifa"\n        },\n        {\n          "activityName": "Dinner at a restaurant in Downtown Dubai",\n          "time": "Evening",\n          "approximateCostINR": 1500,\n          "notes": "Enjoy dinner with a view of the Burj Khalifa and the fountain show.",\n          "travelTimeFromPrevious": "Within Downtown Dubai"\n        }\n      ]\n    },\n    {\n      "day": 3,\n      "theme": "Desert Safari",\n      "activities": [\n        {\n          "activityName": "Desert Safari Tour",\n          "time": "Afternoon/Evening",\n          "approximateCostINR": 2500,\n          "notes": "Book a desert safari tour with hotel pick-up and drop-off. Includes dune bashing, camel riding, sandboarding, BBQ dinner, and entertainment (belly dancing, Tanoura show).",\n          "bookingUrl": "https://www.getyourguide.com/dubai-l171/desert-safari-t94/",\n          "travelTimeFromPrevious": "Hotel pickup, varies."\n        }\n      ]\n    },\n    {\n      "day": 4,\n      "theme": "Beaches and Relaxation",\n      "activities": [\n        {\n          "activityName": "Visit Jumeirah Beach",\n          "time": "Morning",\n          "approximateCostINR": 0,\n          "notes": "Relax on the beach, swim in the sea, and enjoy the views of the Burj Al Arab.",\n          "geoCoordinates": {\n            "latitude": 25.1413,\n            "longitude": 55.1868\n          },\n           "travelTimeFromPrevious": "30 min taxi/bus ride from hotel"\n        },\n        {\n          "activityName": "Visit Burj Al Arab (Optional)",\n          "time": "Afternoon",\n          "approximateCostINR": 10000,\n          "notes": "Have High Tea or Lunch to experience the hotel. This is quite expensive, so consider your budget.",\n          "geoCoordinates": {\n            "latitude": 25.1412,\n            "longitude": 55.1858\n          },\n          "travelTimeFromPrevious": "Adjacent to Jumeirah Beach"\n        },\n        {\n          "activityName": "Explore the Souk Madinat Jumeirah",\n          "time": "Late Afternoon",\n          "approximateCostINR": 0,\n          "notes": "Browse the shops and enjoy the atmosphere of this traditional-style market. Its more touristy than the older souks.",\n          "geoCoordinates": {\n            "latitude": 25.1314,\n            "longitude": 55.1878\n          },\n          "travelTimeFromPrevious": "5 min taxi ride from Jumeirah Beach"\n        },\n        {\n          "activityName": "Dinner at a restaurant at Madinat Jumeirah",\n          "time": "Evening",\n          "approximateCostINR": 2000,\n          "notes": "Enjoy dinner with views of the Burj Al Arab and the waterways.",\n          "travelTimeFromPrevious": "Within Souk Madinat Jumeirah"\n        }\n      ]\n    },\n    {\n      "day": 5,\n      "theme": "Theme Park or Cultural Experience",\n      "activities": [\n        {\n          "activityName": "Option 1: IMG Worlds of Adventure or Dubai Parks and Resorts",\n          "time": "Full Day",\n          "approximateCostINR": 5000,\n          "notes": "Spend the day at a theme park. IMG Worlds of Adventure is an indoor theme park, while Dubai Parks and Resorts includes multiple theme parks (Motiongate, Bollywood Parks, Legoland). Choose based on your interests.",\n          "ticketPricingUrl": "https://www.imgworlds.com/",\n          "ticketPricingUrl2": "https://www.dubaiparksandresorts.com/en",\n          "travelTimeFromPrevious": "45 min - 1 hour taxi ride from Dubai"\n        },\n        {\n          "activityName": "Option 2: Visit Al Fahidi Historical Neighbourhood and the Dubai Museum",\n          "time": "Full Day",\n          "approximateCostINR": 500,\n          "notes": "Explore the historic Al Fahidi district and learn about Dubais history at the Dubai Museum.",\n          "travelTimeFromPrevious": "30 min taxi/metro ride from Hotel"\n        },\n        {\n          "activityName": "Dinner in Al Seef District",\n          "time": "Evening",\n          "approximateCostINR": 1500,\n          "notes": "Explore the Al Seef District and enjoy the views and cultural experience, and have dinner.",\n          "travelTimeFromPrevious": "Variable"\n        }\n      ]\n    },\n    {\n      "day": 6,\n      "theme": "Departure",\n      "activities": [\n        {\n          "activityName": "Souvenir Shopping (if needed)",\n          "time": "Morning",\n          "approximateCostINR": "Variable",\n          "notes": "Last-minute souvenir shopping.",\n          "travelTimeFromPrevious": "Variable"\n        },\n        {\n          "activityName": "Check out from Hotel",\n          "time": "Late Morning",\n          "approximateCostINR": 0,\n          "notes": "Prepare for departure."\n        },\n        {\n          "activityName": "Departure from Dubai International Airport (DXB)",\n          "time": "Afternoon",\n          "approximateCostINR": 0,\n          "notes": "Take a taxi or the metro to the airport.",\n          "travelTimeFromPrevious": "Variable, depending on airport transfer method."\n        }\n      ]\n    }\n  ],\n  "budgetSummary": {\n    "flightsINR": 25000,\n    "accommodationINR": 20000,\n    "activitiesINR": 15000,\n    "foodINR": 9000,\n    "transportINR": 3000,\n    "totalApproximateCostINR": 72000,\n    "notes": "This is an estimated budget. Actual costs may vary depending on your spending habits and choices."\n  },\n  "importantNotes": [\n    "Dress modestly when visiting religious sites.",\n    "Stay hydrated, especially during the hotter months.",\n    "Bargain respectfully when shopping in the souks.",\n    "Be aware of local customs and laws.",\n    "Carry a copy of your passport and visa.",\n    "Learn a few basic Arabic phrases.",\n    "Download useful apps like Careem (ride-hailing), The Entertainer (for discounts), and a currency converter."\n  ]\n}\n```',
        },
      ],
    },
  ],
});

// const result = await chatSession.sendMessage("INSERT_INPUT_HERE");
// console.log(result.response.text());
